import{u as H,a as G}from"./index-88317f61.js";/* empty css                  */import{l as g,y as o,z as i,A as s,B as c,C as b,u as C,Y as Z,Z as f,Q as v,_ as V,I as L,$ as J,r as M,w as U,M as K,a0 as F,O as N,U as W,a1 as X,a2 as ee,a3 as te,a4 as ae,a5 as le,a6 as se,a7 as I,a8 as oe,a9 as ne,aa as re,ab as ie,ac as Q,ad as T,ae as q,af as ce,F as ue,G as de,H as ve}from"./element-plus-f32ef508.js";/* empty css                    */import{_ as B}from"./leaflet-5945a372.js";import"./echarts-37646912.js";const me={class:"loading-content"},fe={class:"loading-spinner"},_e={key:0,class:"loading-text"},he={key:1,class:"loading-subtext"},ye={key:2,class:"loading-progress"},be={__name:"LoadingState",props:{text:{type:String,default:"加载中..."},subtext:{type:String,default:""},size:{type:String,default:"medium",validator:e=>["small","medium","large"].includes(e)},inline:{type:Boolean,default:!1},progress:{type:Number,default:null},showProgress:{type:Boolean,default:!0}},setup(e){const u=e,r=g(()=>({small:16,medium:24,large:32})[u.size]),_=g(()=>({small:4,medium:6,large:8})[u.size]);return(m,n)=>{const d=L,p=J;return o(),i("div",{class:V(["loading-state",[`loading-${e.size}`,{inline:e.inline}]])},[s("div",me,[s("div",fe,[c(d,{class:"is-loading",size:r.value},{default:b(()=>[c(C(Z))]),_:1},8,["size"])]),e.text?(o(),i("div",_e,f(e.text),1)):v("",!0),e.subtext?(o(),i("div",he,f(e.subtext),1)):v("",!0),e.progress!==null?(o(),i("div",ye,[c(p,{percentage:e.progress,"show-text":e.showProgress,"stroke-width":_.value},null,8,["percentage","show-text","stroke-width"])])):v("",!0)])],2)}}},Y=B(be,[["__scopeId","data-v-f8fadb1b"]]);const ge={class:"animated-number"},pe={__name:"AnimatedNumber",props:{value:{type:[Number,String],required:!0},format:{type:String,default:"number",validator:e=>["number","currency","percentage","compact"].includes(e)},duration:{type:Number,default:1e3},decimals:{type:Number,default:0},prefix:{type:String,default:""},suffix:{type:String,default:""},locale:{type:String,default:"zh-CN"}},setup(e){const u=e,r=M(0),_=g(()=>{const n=Number(r.value);if(isNaN(n))return u.value;let d="";switch(u.format){case"currency":d=new Intl.NumberFormat(u.locale,{style:"currency",currency:"CNY",minimumFractionDigits:u.decimals,maximumFractionDigits:u.decimals}).format(n);break;case"percentage":d=new Intl.NumberFormat(u.locale,{style:"percent",minimumFractionDigits:u.decimals,maximumFractionDigits:u.decimals}).format(n/100);break;case"compact":n>=1e6?d=(n/1e6).toFixed(u.decimals)+"M":n>=1e3?d=(n/1e3).toFixed(u.decimals)+"K":d=n.toFixed(u.decimals);break;default:d=new Intl.NumberFormat(u.locale,{minimumFractionDigits:u.decimals,maximumFractionDigits:u.decimals}).format(n)}return u.prefix+d+u.suffix}),m=(n,d,p)=>{if(n===d)return;const S=performance.now(),$=Number(n)||0,k=Number(d)||0,x=k-$,w=l=>1-Math.pow(1-l,4),t=l=>{const y=l-S,a=Math.min(y/p,1),h=w(a);r.value=$+x*h,a<1?requestAnimationFrame(t):r.value=k};requestAnimationFrame(t)};return U(()=>u.value,(n,d)=>{const p=Number(n);isNaN(p)?r.value=n:m(r.value,p,u.duration)},{immediate:!1}),K(()=>{const n=Number(u.value);isNaN(n)?r.value=u.value:m(0,n,u.duration)}),(n,d)=>(o(),i("span",ge,f(_.value),1))}},ke=B(pe,[["__scopeId","data-v-d6d724f2"]]);const $e={key:0,class:"card-loading"},xe={key:1,class:"card-content"},we={class:"card-header"},Ce={class:"stat-info"},Se={class:"stat-number"},De={class:"stat-label"},Ne={key:0,class:"card-trend"},ze={class:"trend-value"},Be={class:"trend-description"},Fe={key:1,class:"card-subtitle"},Ie={key:2,class:"card-chart"},Ve={class:"mini-chart"},Me={viewBox:"0 0 100 30",class:"trend-line"},Le=["points","stroke"],Ee={key:2,class:"click-indicator"},Ae={__name:"InteractiveStatCard",props:{label:{type:String,required:!0},value:{type:[Number,String],required:!0},subtitle:{type:String,default:""},icon:{type:String,default:""},iconColor:{type:String,default:"#409eff"},loading:{type:Boolean,default:!1},clickable:{type:Boolean,default:!1},numberFormat:{type:String,default:"number"},trendValue:{type:Number,default:null},trendDescription:{type:String,default:""},showChart:{type:Boolean,default:!1},chartData:{type:Array,default:()=>[]},chartColor:{type:String,default:"#409eff"}},emits:["click"],setup(e,{emit:u}){const r=e,_=u,m=g(()=>r.trendValue!==null&&r.trendDescription),n=g(()=>r.trendValue>0?"up":r.trendValue<0?"down":"stable"),d=g(()=>{if(!r.chartData||r.chartData.length===0)return"";const S=Math.max(...r.chartData),$=Math.min(...r.chartData),k=S-$||1;return r.chartData.map((x,w)=>{const t=w/(r.chartData.length-1)*100,l=30-(x-$)/k*30;return`${t},${l}`}).join(" ")}),p=()=>{r.clickable&&_("click")};return(S,$)=>{const k=L;return o(),i("div",{class:V(["stat-card",{clickable:e.clickable,"has-trend":m.value,loading:e.loading}]),onClick:p},[e.loading?(o(),i("div",$e,[c(Y,{size:"small",text:""})])):(o(),i("div",xe,[s("div",we,[e.icon?(o(),i("div",{key:0,class:"stat-icon",style:F({backgroundColor:e.iconColor})},[c(k,{size:24},{default:b(()=>[(o(),N(W(e.icon)))]),_:1})],4)):v("",!0),s("div",Ce,[s("div",Se,[c(ke,{value:e.value,format:e.numberFormat},null,8,["value","format"])]),s("div",De,f(e.label),1)])]),m.value?(o(),i("div",Ne,[s("div",{class:V(["trend-indicator",n.value])},[c(k,{size:16},{default:b(()=>[n.value==="up"?(o(),N(C(X),{key:0})):v("",!0),n.value==="down"?(o(),N(C(ee),{key:1})):v("",!0),n.value==="stable"?(o(),N(C(te),{key:2})):v("",!0)]),_:1}),s("span",ze,f(e.trendValue)+"%",1)],2),s("div",Be,f(e.trendDescription),1)])):v("",!0),e.subtitle?(o(),i("div",Fe,f(e.subtitle),1)):v("",!0),e.showChart&&e.chartData?(o(),i("div",Ie,[s("div",Ve,[(o(),i("svg",Me,[s("polyline",{points:d.value,fill:"none",stroke:e.chartColor,"stroke-width":"2"},null,8,Le)]))])])):v("",!0)])),e.clickable?(o(),i("div",Ee,[c(k,null,{default:b(()=>[c(C(ae))]),_:1})])):v("",!0)],2)}}},P=B(Ae,[["__scopeId","data-v-181a32b2"]]);const Pe={class:"error-content"},Te={class:"error-icon"},qe={class:"error-title"},Oe={key:0,class:"error-description"},Re={key:1,class:"error-details"},je={class:"error-code"},He={class:"error-actions"},Ue={__name:"ErrorState",props:{title:{type:String,default:"出现了一些问题"},description:{type:String,default:"请稍后重试，如果问题持续存在，请联系技术支持"},errorDetails:{type:String,default:""},showDetails:{type:Boolean,default:!1},showRetry:{type:Boolean,default:!0},showHome:{type:Boolean,default:!1},size:{type:String,default:"medium",validator:e=>["small","medium","large"].includes(e)}},emits:["retry"],setup(e,{emit:u}){const r=H(),_=e,m=u,n=M(!1),d=M([]),p=g(()=>({small:32,medium:48,large:64})[_.size]),S=async()=>{n.value=!0;try{await m("retry")}finally{n.value=!1}},$=()=>{r.push("/")};return(k,x)=>{const w=L,t=re,l=ie,y=Q;return o(),i("div",{class:V(["error-state",`error-${e.size}`])},[s("div",Pe,[s("div",Te,[c(w,{size:p.value,color:"#f56c6c"},{default:b(()=>[c(C(le))]),_:1},8,["size"])]),s("div",qe,f(e.title),1),e.description?(o(),i("div",Oe,f(e.description),1)):v("",!0),e.showDetails&&e.errorDetails?(o(),i("div",Re,[c(l,{modelValue:d.value,"onUpdate:modelValue":x[0]||(x[0]=a=>d.value=a)},{default:b(()=>[c(t,{title:"查看详细信息",name:"details"},{default:b(()=>[s("div",je,f(e.errorDetails),1)]),_:1})]),_:1},8,["modelValue"])])):v("",!0),s("div",He,[e.showRetry?(o(),N(y,{key:0,type:"primary",onClick:S,loading:n.value},{default:b(()=>[c(w,null,{default:b(()=>[c(C(se))]),_:1}),x[1]||(x[1]=I(" 重试 "))]),_:1,__:[1]},8,["loading"])):v("",!0),e.showHome?(o(),N(y,{key:1,onClick:$},{default:b(()=>[c(w,null,{default:b(()=>[c(C(oe))]),_:1}),x[2]||(x[2]=I(" 返回首页 "))]),_:1,__:[2]})):v("",!0),ne(k.$slots,"actions",{},void 0,!0)])])],2)}}},Ke=B(Ue,[["__scopeId","data-v-fc658589"]]);const Qe={class:"interactive-bar-chart"},Ye={key:0,class:"chart-header"},Ge={key:0,class:"chart-title"},Ze={key:1,class:"chart-subtitle"},Je={key:1,class:"chart-legend"},We={class:"legend-items"},Xe={class:"legend-label"},et={class:"legend-value"},tt={class:"chart-container"},at={key:2,class:"chart-content"},lt={class:"chart-bars"},st=["onClick","onMouseenter"],ot={class:"item-label"},nt=["title"],rt={key:0,class:"label-subtitle"},it={class:"item-bar-container"},ct={key:0,class:"bar-value"},ut={class:"item-count"},dt={class:"count-value"},vt={key:0,class:"count-percentage"},mt={key:3,class:"empty-state"},ft={class:"tooltip-content"},_t={class:"tooltip-title"},ht={class:"tooltip-items"},yt={class:"tooltip-label"},bt={class:"tooltip-value"},gt={__name:"InteractiveBarChart",props:{data:{type:[Object,Array],required:!0},title:{type:String,default:""},subtitle:{type:String,default:""},colorScheme:{type:Array,default:()=>["#6366f1","#8b5cf6","#06b6d4","#10b981","#f59e0b","#ef4444","#ec4899","#84cc16"]},loading:{type:Boolean,default:!1},loadingText:{type:String,default:"正在加载图表数据..."},error:{type:Object,default:null},clickable:{type:Boolean,default:!0},showValues:{type:Boolean,default:!0},showPercentage:{type:Boolean,default:!0},showLegend:{type:Boolean,default:!1},valueFormatter:{type:Function,default:e=>e},labelTranslator:{type:Function,default:e=>e}},emits:["item-click","item-hover","retry"],setup(e,{emit:u}){const r=e,_=u,m=M(-1),n=M({visible:!1,x:0,y:0,title:"",items:[]}),d=g(()=>{let t=[];if(Array.isArray(r.data)?t=r.data:typeof r.data=="object"&&(t=Object.entries(r.data).map(([a,h])=>({label:a,value:Number(h)||0}))),t.length===0)return[];const l=t.reduce((a,h)=>a+(h.value||0),0),y=Math.max(...t.map(a=>a.value||0));return t.map((a,h)=>{const D=Number(a.value)||0,E=y>0?D/y*100:0,A=l>0?(D/l*100).toFixed(1):0;return{...a,originalLabel:a.label,label:r.labelTranslator(a.label),value:D,percentage:Math.max(E,2),valuePercentage:A,color:a.color||r.colorScheme[h%r.colorScheme.length]}})}),p=g(()=>d.value.map(t=>({label:t.label,color:t.color,value:$(t.value)}))),S=t=>r.valueFormatter(t),$=t=>t>=1e6?(t/1e6).toFixed(1)+"M":t>=1e3?(t/1e3).toFixed(1)+"K":t.toString(),k=(t,l)=>{r.clickable&&(m.value=m.value===l?-1:l,_("item-click",{item:t,index:l}))},x=(t,l,y)=>{const a=y.currentTarget.getBoundingClientRect();n.value={visible:!0,x:a.right+10,y:a.top+a.height/2,title:t.label,items:[{label:"数量",value:$(t.value),color:t.color},{label:"占比",value:t.valuePercentage+"%",color:t.color}]},_("item-hover",{item:t,index:l})},w=()=>{n.value.visible=!1};return U(()=>r.data,()=>{m.value=-1}),(t,l)=>{const y=L;return o(),i("div",Qe,[e.title||e.subtitle?(o(),i("div",Ye,[e.title?(o(),i("h3",Ge,f(e.title),1)):v("",!0),e.subtitle?(o(),i("p",Ze,f(e.subtitle),1)):v("",!0)])):v("",!0),e.showLegend?(o(),i("div",Je,[s("div",We,[(o(!0),i(T,null,q(p.value,a=>(o(),i("div",{class:"legend-item",key:a.label},[s("span",{class:"legend-color",style:F({backgroundColor:a.color})},null,4),s("span",Xe,f(a.label),1),s("span",et,f(a.value),1)]))),128))])])):v("",!0),s("div",tt,[e.loading?(o(),N(Y,{key:0,text:e.loadingText,size:"medium"},null,8,["text"])):e.error?(o(),N(Ke,{key:1,title:e.error.title||"图表加载失败",description:e.error.description,size:"small",onRetry:l[0]||(l[0]=a=>t.$emit("retry"))},null,8,["title","description"])):d.value.length>0?(o(),i("div",at,[s("div",lt,[(o(!0),i(T,null,q(d.value,(a,h)=>(o(),i("div",{key:a.label,class:V(["chart-item",{clickable:e.clickable,active:m.value===h}]),onClick:D=>k(a,h),onMouseenter:D=>x(a,h,D),onMouseleave:l[1]||(l[1]=D=>w())},[s("div",ot,[s("span",{class:"label-text",title:a.originalLabel||a.label},f(a.label),9,nt),a.subtitle?(o(),i("span",rt,f(a.subtitle),1)):v("",!0)]),s("div",it,[s("div",{class:"item-bar",style:F({width:a.percentage+"%",backgroundColor:a.color,animationDelay:h*100+"ms"})},[e.showValues?(o(),i("span",ct,f(S(a.value)),1)):v("",!0)],4)]),s("div",ut,[s("span",dt,f($(a.value)),1),e.showPercentage?(o(),i("span",vt,f(a.valuePercentage)+"% ",1)):v("",!0)])],42,st))),128))])])):(o(),i("div",mt,[c(y,{size:32,color:"#c0c4cc"},{default:b(()=>[c(C(ce))]),_:1}),l[2]||(l[2]=s("p",null,"暂无数据",-1))]))]),n.value.visible?(o(),i("div",{key:2,class:"chart-tooltip",style:F({left:n.value.x+"px",top:n.value.y+"px"})},[s("div",ft,[s("div",_t,f(n.value.title),1),s("div",ht,[(o(!0),i(T,null,q(n.value.items,a=>(o(),i("div",{key:a.label,class:"tooltip-item"},[s("span",{class:"tooltip-color",style:F({backgroundColor:a.color})},null,4),s("span",yt,f(a.label)+":",1),s("span",bt,f(a.value),1)]))),128))])])],4)):v("",!0)])}}},j=B(gt,[["__scopeId","data-v-ad124d37"]]);const pt={class:"dashboard"},kt={class:"dashboard-container"},$t={class:"stats-grid"},xt={class:"charts-grid"},wt={class:"quick-actions"},Ct={class:"card"},St={class:"card-body"},Dt={class:"action-buttons"},Nt={__name:"Dashboard",setup(e){const u=H(),r=G(),_=g(()=>r.summary),m=g(()=>r.loading),n=g(()=>r.error),d=g(()=>{var t;return(t=_.value)==null?void 0:t.star_distribution}),p=g(()=>{var a;const t=(a=_.value)==null?void 0:a.price_distribution;if(!t)return null;const l=["Budget","Moderate","Expensive","Very Expensive","Luxury","Unknown"],y={};return l.forEach(h=>{t[h]!==void 0&&(y[h]=t[h])}),y});g(()=>{var t;return((t=_.value)==null?void 0:t.total_restaurants)||0}),g(()=>d.value?Math.max(...Object.values(d.value)):0),g(()=>p.value?Math.max(...Object.values(p.value)):0);const S=t=>`${t}星`,$=t=>({Budget:"经济型",Moderate:"适中型",Expensive:"高价型","Very Expensive":"豪华型",Luxury:"奢华型",Unknown:"未知"})[t]||t,k=({item:t})=>{u.push({path:"/analytics",query:{stars:t.originalLabel||t.label}})},x=({item:t})=>{u.push({path:"/explore",query:{price:t.originalLabel||t.label}})},w=async()=>{try{await r.fetchSummary()}catch(t){console.error("重试失败:",t)}};return K(async()=>{if(!_.value)try{await r.fetchSummary()}catch(t){console.error("获取摘要数据失败:",t)}}),(t,l)=>{var h,D,E,A,O,R;const y=L,a=Q;return o(),i("div",pt,[s("div",kt,[l[11]||(l[11]=s("div",{class:"page-header"},[s("h1",{class:"page-title"},"数据概览"),s("p",{class:"page-subtitle"},"全球米其林星级餐厅数据总览和关键指标")],-1)),s("div",$t,[c(P,{label:"总餐厅数",value:((h=_.value)==null?void 0:h.total_restaurants)||0,icon:"Shop","icon-color":"#3b82f6",loading:m.value,clickable:"",subtitle:"全球米其林星级餐厅",onClick:l[0]||(l[0]=z=>t.$router.push("/explore"))},null,8,["value","loading"]),c(P,{label:"覆盖地区",value:((D=_.value)==null?void 0:D.regions)||0,icon:"Location","icon-color":"#10b981",loading:m.value,clickable:"",subtitle:"分布在不同地区",onClick:l[1]||(l[1]=z=>t.$router.push("/map"))},null,8,["value","loading"]),c(P,{label:"覆盖城市",value:((E=_.value)==null?void 0:E.cities)||0,icon:"OfficeBuilding","icon-color":"#f59e0b",loading:m.value,clickable:"",subtitle:"遍布全球主要城市",onClick:l[2]||(l[2]=z=>t.$router.push("/map"))},null,8,["value","loading"]),c(P,{label:"菜系类型",value:((A=_.value)==null?void 0:A.cuisines)||0,icon:"Bowl","icon-color":"#8b5cf6",loading:m.value,clickable:"",subtitle:"丰富多样的美食文化",onClick:l[3]||(l[3]=z=>t.$router.push("/analytics"))},null,8,["value","loading"])]),s("div",xt,[c(j,{data:d.value,title:"星级分布",subtitle:"不同星级餐厅的数量分布情况",loading:m.value,error:((O=n.value)==null?void 0:O.type)==="fetch_summary"?n.value:null,"color-scheme":["#6366f1","#8b5cf6","#ec4899"],"label-translator":S,"show-legend":"",onItemClick:k,onRetry:w},null,8,["data","loading","error"]),c(j,{data:p.value,title:"价格分布",subtitle:"不同价格区间餐厅的分布比例",loading:m.value,error:((R=n.value)==null?void 0:R.type)==="fetch_summary"?n.value:null,"color-scheme":["#10b981","#f59e0b","#ef4444","#8b5cf6","#06b6d4"],"label-translator":$,"show-legend":"",onItemClick:x,onRetry:w},null,8,["data","loading","error"])]),s("div",wt,[s("div",Ct,[l[10]||(l[10]=s("div",{class:"card-header"},[s("h3",{class:"card-title"},"快速操作")],-1)),s("div",St,[s("div",Dt,[c(a,{type:"primary",size:"large",onClick:l[4]||(l[4]=z=>t.$router.push("/map"))},{default:b(()=>[c(y,null,{default:b(()=>[c(C(ue))]),_:1}),l[7]||(l[7]=I(" 查看地图分布 "))]),_:1,__:[7]}),c(a,{type:"success",size:"large",onClick:l[5]||(l[5]=z=>t.$router.push("/analytics"))},{default:b(()=>[c(y,null,{default:b(()=>[c(C(de))]),_:1}),l[8]||(l[8]=I(" 深度分析 "))]),_:1,__:[8]}),c(a,{type:"info",size:"large",onClick:l[6]||(l[6]=z=>t.$router.push("/explore"))},{default:b(()=>[c(y,null,{default:b(()=>[c(C(ve))]),_:1}),l[9]||(l[9]=I(" 数据探索 "))]),_:1,__:[9]})])])])])])])}}},Lt=B(Nt,[["__scopeId","data-v-4a8515d1"]]);export{Lt as default};
